---
title: An Analysis of Advertisements on Public Transport in Auckland.
output: html_document
---

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)
```

```{js}
$(function() {
  $(".level2").css('visibility', 'hidden');
  $(".level2").first().css('visibility', 'visible');
  $(".container-fluid").height($(".container-fluid").height() + 300);
  $(window).on('scroll', function() {
    $('h2').each(function() {
      var h2Top = $(this).offset().top - $(window).scrollTop();
      var windowHeight = $(window).height();
      if (h2Top >= 0 && h2Top <= windowHeight / 2) {
        $(this).parent('div').css('visibility', 'visible');
      } else if (h2Top > windowHeight / 2) {
        $(this).parent('div').css('visibility', 'hidden');
      }
    });
  });
})
```


```{r}
library(tidyverse)

input_data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSbqICsnauOgFuy8YcfKDdfFPSx3WVemKL8uUVb7UmRIo8mLhLH00Tw5--J44XsIn0xPqFqrWCR9-Ap/pub?output=csv")

logged_data <- input_data %>% rename(public_transport_type = 2, time_taken = 3, advertisement_type = 5, number_of_ads = 4)


median_transport_time_for_each <- logged_data %>% 
  group_by(public_transport_type) %>%
  mutate(median_time = median(time_taken, na.rm = TRUE)) 

test <- median_transport_time_for_each %>%
  group_by(public_transport_type) %>%
  summarise(median_value = mean(time_taken, na.rm = TRUE))


################################################
before_or_after_lunch_transport <- logged_data %>%
  mutate(log_datetime = dmy_hms(Timestamp),
         time_period = ifelse(hour(log_datetime) > 12, "After lunch", "Before lunch"))

count_df <- before_or_after_lunch_transport %>%
  count(public_transport_type, time_period)


################################################################

#plot 3

ad_type <- logged_data %>%
  mutate(
    is_drink = str_detect(advertisement_type, "drink"),
    is_food = str_detect(advertisement_type, "food"),
  ) 
ad_df <- ad_type %>%
  filter(is_drink == TRUE | is_food == TRUE) %>%
  mutate(ad_type = case_when(
    is_drink ~ "Drink",
    is_food  ~ "Food"
  ))
 

```


```{css}
.figcaption {display: none}
body {
  color: #045a8d;
  background-color: #f1eef6; 
  font-family: "Trirong", serif;
  margin: 20px;
}

h1 {
  font-weight: bold;
  text-decoration: underline;
  color: #2b8cbe; 
  padding-bottom: 10px;
}

h2 {
  font-weight: bold;
  color: #74a9cf; 
  margin-top: 30px;
}

img {
  border: 5px solid #bdc9e1; 
  border-radius: 5%;
 

}
```


## Analyses of public transport and the time taken to reach distinations using a box and wisker plot.

![box and wisker plot](plot1.png)
From the box plot we can see that the bus on average takes the longest (`r test$median_value[1]`min) followed by trains (`r test$median_value[2]`min), ferry(`r test$median_value[4]`min)  and then other (`r test$median_value[3]` min) modes of public transport. This could have occurred due to multiple reasons however I think this is due to the distance covered by each method. For example E-scooters were included in "other" and were used only for short distance hence time which could have skewed the data and make the "other" category seem better in terms of travel time. While buses for me personally  were used to commute to uni and often encountered traffic making the time taken to travel much higher. This could also explain why the bus data was more spread and had more extreme values compared to the others. We also can see that Bus had the longest trip, taking `r max(logged_data$time_taken)` min while other had the shortest trip taking `r min(logged_data$time_taken)` min.  



## Visualising when public transport trips were taken 

![vertical bar graph](plot2.png)
Looking at the bar graph we can see that the most public transport trips taken before and after lunch were taken on the bus (13). Followed by taking the train for both categories. However for trips after lunch "other" is a close contender with trains (5 vs 6). Interestingly the number of trips after vs before lunch for "other" was the same (5) while for the ferry the number of trips after lunch was heavily favored compared to before lunch. We further see that overall ferries had the lowest number of trips taken before lunch, while "other" had the lowest number of trips after lunch (5). 



## Determining which type of ad is more popular per transport group. 

![horizontal bar graph](plot3.png)
From this graph we can see the proportion of drink vs food ads seen on public transport. We see that out of all the ads seen on ferries none were related to food. While for both trains and buses around 26%(for buses) were related to food. However for "other" public transport methods we see 75% of the ads seen were related to food. Overall there could be multiple factors which could explain this data. Firstly not that much data was collect for ferries and "other" transport methods compared to the other groups. The "other" category was also mostly E-scooters which were used in the CBD which had lots more restaurants displaying food adverts which may have impacted the results of this graph.    



